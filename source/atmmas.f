      function atmmas(anclr)
c---------------------------------------------------------------------
c     Given a nuclear charge, this program returns the corresponding
c     average atomic mass.
c     Coded by H. Akai, 27 May 1997, Osaka
c---------------------------------------------------------------------
      implicit real*8 (a-h,o-z)
      real*8 a(0:107)
      data a/0d0,1.00794d0,
     &     4.002602d0,6.941d0,9.01282d0,10.811d0,12.011d0,14.00674d0,
     &     15.9994d0,18.9984032d0,20.1797d0,22.989768d0,24.3050d0,
     &     26.981539d0,28.0855d0,30.973762d0,32.066d0,35.4527d0,
     &     39.948d0,39.0983d0,40.078d0,44.95591d0,47.88d0,50.9415d0,
     &     51.9961d0,54.93805d0,55.847d0,58.93320d0,58.69d0,63.546d0,
     &     65.39d0,69.723d0,72.61d0,74.92159d0,78.96d0,79.904d0,
     &     83.80d0,85.4678d0,87.62d0,88.90585d0,91.224d0,92.90638d0,
     &     95.94d0,98.9063d0,101.07d0,102.90550d0,106.42d0,
     &     107.8682d0,112.411d0,114.82d0,118.710d0,121.75d0,127.60d0,
     &     126.90447d0,131.29d0,132.90543d0,137.327d0,138.9055d0,
     &     140.115d0,140.90765d0,144.24d0,146.9151d0,150.36d0,
     &     151.965d0,157.25d0,158.92534d0,162.50d0,164.93032d0,
     &     167.26d0,168.93421d0,173.04d0,174.967d0,178.49d0,
     &     180.9479d0,183.85d0,186.207d0,190.2d0,192.22d0,195.08d0,
     &     196.96654d0,200.59d0,204.3833d0,207.2d0,208.98037d0,
     &     208.9824d0,209.9871d0,222.0176d0,223.0197d0,226.0254d0,
     &     227.0278d0,232.0381d0,231.0359d0,238.0289d0,237.0482d0,
     &     244.0642d0,243.0614d0,247.0703d0,247.0703d0,251.0796d0,
     &     252.0829d0,257.0951d0,258.0986d0,259.1009d0,260.1053d0,
     &     261.1087d0,262.1138d0,263.1182d0,262.1229d0/
      n=anclr+1d-10
      if(n .lt. 0 .or. n .gt. 107)
     &     call errtrp(1,'atmmas','illegal anclr')
      atmmas=dble(a(n))
      end
